(()=>{var Pt=Object.create;var ot=Object.defineProperty;var Gt=Object.getOwnPropertyDescriptor;var Jt=Object.getOwnPropertyNames;var Wt=Object.getPrototypeOf,Ht=Object.prototype.hasOwnProperty;var Ut=(a,o)=>()=>(o||a((o={exports:{}}).exports,o),o.exports);var qt=(a,o,s,i)=>{if(o&&typeof o=="object"||typeof o=="function")for(let l of Jt(o))!Ht.call(a,l)&&l!==s&&ot(a,l,{get:()=>o[l],enumerable:!(i=Gt(o,l))||i.enumerable});return a};var xt=(a,o,s)=>(s=a!=null?Pt(Wt(a)):{},qt(o||!a||!a.__esModule?ot(s,"default",{value:a,enumerable:!0}):s,a));var st=Ut((_,it)=>{(function(a,o){typeof _=="object"&&typeof it<"u"?o(_):typeof define=="function"&&define.amd?define(["exports"],o):(a=typeof globalThis<"u"?globalThis:a||self,o(a.tibetanCalendarCalculator={}))})(_,(function(a){"use strict";var o=1027,s=60,i=127,l=24405875e-1,f=864e5,b=1440,p=806,L=3,A=61,N=123,dt=2015501+4783/5656,U=167025/5656,yt=U/30,bt=743/804,q=65/804,Dt=q/30,mt=475/3528,Mt=253/3528,gt=1/28,O=[0,5,10,15,19,22,24,25],$=[0,6,10,11],Lt=["Wood","Fire","Earth","Iron","Water"],Yt=["Mouse","Ox","Tiger","Rabbit","Dragon","Snake","Horse","Sheep","Monkey","Bird","Dog","Pig"],St=["Male","Female"],x=function(e){return e%1},z=function(e,t){return e%t||t},E=function(e){var t=e.getFullYear(),r=e.getMonth()+1,n=e.getDate();return"".concat(t,"-").concat("0".concat(r).slice(-2),"-").concat("0".concat(n).slice(-2))},K=function(e,t){return e===1?{day:30,monthCount:t-1}:{day:e-1,monthCount:t}},k=function(e,t){var r=12*(e-i-p)+t;return 2*r%65===N%65||2*r%65===(N+1)%65},jt=function(e,t){return t*U+e*yt+dt},Tt=function(e,t){return t*Mt+e*gt+mt},X=function(e){var t=e%28;return t<=7?O[t]:t<=14?O[14-t]:t<=21?-O[t-14]:-O[28-t]},wt=function(e){var t=X(Math.floor(e)),r=x(e);if(r){var n=X(Math.floor(e)+1);t+=(n-t)*r}return t},Et=function(e,t){return wt(28*Tt(e,t))},At=function(e,t){return t*q+e*Dt+bt},Nt=function(e,t){return At(e,t)-1/4},Q=function(e){var t=e%12;return t<=3?$[t]:t<=6?$[6-t]:t<=9?-$[t-6]:-$[12-t]},Ot=function(e){var t=Q(Math.floor(e)),r=x(e);if(r){var n=Q(Math.floor(e)+1);t+=(n-t)*r}return t},$t=function(e,t){return Ot(12*Nt(e,t))},P=function(){return P=Object.assign||function(t){for(var r,n=1,h=arguments.length;n<h;n++){r=arguments[n];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},P.apply(this,arguments)};typeof SuppressedError=="function"&&SuppressedError;var V=function(e){var t=P({},e),r=t.tibYear;return t.animal=Yt[(r+1)%12],t.element=Lt[Math.floor((r-1)/2%5)],t.gender=St[(r+1)%2],t},kt=function(e){var t=E(e),r=new Date("".concat(t,"T18:00:00"));return Math.floor(+r/f-e.getTimezoneOffset()/b+l)},F=function(e){var t=e.year,r=e.month,n=e.isLeapMonth,h=t-i,u=12*(h-p)+r-L,c=k(t,r),d=c&&n?1:0;return Math.floor((67*u+A+17)/65)-d},Y=function(e,t){return jt(e,t)+Et(e,t)/60-$t(e,t)/60},Z=function(e,t,r,n){var h=F({year:e,month:t,isLeapMonth:r});return Math.floor(Y(n,h))},tt=function(e){var t=Math.floor((e-1)/30),r=e%30||30;return Math.floor(Y(r,t))},C=function(e){var t=new Date().getTimezoneOffset(),r=(e-l+t/b)*f,n=new Date(r);return n},Ft=function(e,t){t===void 0&&(t=!0);var r=t?e:e+i,n=1+Z(r-1,12,!1,30);return E(C(n))},Ct=function(e){var t=Math.ceil((65*e+N)/67),r=z(t,12),n=Math.ceil(t/12)-1+p+i,h=Math.ceil((65*(e+1)+N)/67)===t;return{year:n,month:r,isLeapMonth:h}},et=function(e){var t=e.year,r=e.month,n=e.isLeapMonth,h=n===void 0?!1:n,u=e.day,c=e.isLeapDay,d=c===void 0?!1:c,y=Z(t,r,h,u),m=F({year:t,month:r,isLeapMonth:h}),v=K(u,m),M=Math.floor(Y(v.day,v.monthCount)),R=K(v.day,v.monthCount),J=Math.floor(Y(R.day,R.monthCount)),j=k(t,r),B=y===M+2,W=y===M,H=M===J,D=d&&B;D&&y--;var _t=C(y);return{year:t,month:{month:r,isLeapMonth:h&&j,isDoubledMonth:j},day:u,skippedDay:W,isPreviousSkipped:H,isLeapDay:D,isDoubledDay:B,westernDate:_t}},rt=function(e){for(var t=e.getFullYear(),r=kt(e),n=[t+i-1,t+i+1],h=n.map(function(D){return F({year:D,month:1,isLeapMonth:!0})}),u=h.map(function(D){return 1+30*D}),c=u.map(function(D){return tt(D)});u[0]<u[1]-1&&c[0]<c[1];){var d=Math.floor((u[0]+u[1])/2),y=tt(d);y<r?(u[0]=d,c[0]=y):(u[1]=d,c[1]=y)}var m,v;c[0]===r?(m=c[0],v=u[0]):(m=c[1],v=u[1]);var M=m>r,R=Math.floor((v-1)/30),J=v%30||30,j=Ct(R),B=j.year,W=j.month,H=j.isLeapMonth;return et({year:B,month:W,isLeapMonth:H,day:J,isLeapDay:M})},at=function(e){return V({rabjungCycle:Math.ceil((e-o+1)/s),rabjungYear:z(e-o+1,s),tibYear:e+i,westernYear:e})},nt=function(e){return at(e-i)},It=function(e){var t=e.rabjungCycle,r=e.rabjungYear;if(t<1||r>s)throw new Error("Year number must be between 1 and ".concat(s));var n=o+(t-1)*s+(r-1),h=V({rabjungCycle:t,rabjungYear:r,tibYear:n+i,westernYear:n});return h},G=(function(){function e(t,r){r===void 0&&(r=!1);var n;if(t)typeof t=="number"?r?n=at(t):n=nt(t):n=It(t);else{var h=new Date,u=new S(h.toISOString());n=nt(u.year)}this.rabjungCycle=n.rabjungCycle,this.rabjungYear=n.rabjungYear,this.tibYearNum=n.tibYear,this.westernYear=n.westernYear,this.animal=n.animal,this.element=n.element,this.gender=n.gender,this.months=[]}return e.prototype.getMonths=function(){if(this.months.length)return this.months;for(var t=1;t<=12;t++){var r=new I({year:this.tibYearNum,month:t});if(this.months.push(r),k(this.tibYearNum,t)){var n=new I({year:this.tibYearNum,month:t,isLeapMonth:!0});this.months.push(n)}}return this.months},e.prototype.toString=function(){return"".concat(this.tibYearNum)},e.prototype.toRabjungString=function(){return"The ".concat(this.rabjungYear,". year of the ").concat(this.rabjungCycle,". rabjung cycle")},e})(),Rt=function(e){var t=e.year,r=e.month,n=e.isLeapMonth,h=n===void 0?!1:n,u=k(t,r),c=h&&u,d=F({year:t,month:r,isLeapMonth:c}),y=1+Math.floor(Y(30,d-1)),m=Math.floor(Y(30,d)),v=E(C(y)),M=E(C(m));return{year:t,month:r,isLeapMonth:c,isDoubledMonth:u,startDate:v,endDate:M}},I=(function(){function e(t){var r,n;t?typeof t=="string"?(r=new Date(t),n=new S(r.toISOString())):(this.year=t.year,this.month=t.month,this.isLeapMonth=t.isLeapMonth||!1):(r=new Date,n=new S(r.toISOString())),n&&(this.year=n.year,this.month=n.month,this.isLeapMonth=n.monthObj.isLeapMonth);var h=Rt({year:this.year,month:this.month,isLeapMonth:this.isLeapMonth});this.isDoubledMonth=h.isDoubledMonth,this.startDateStr=h.startDate,this.endDateStr=h.endDate,this.days=[]}return Object.defineProperty(e.prototype,"yearObj",{get:function(){return new G(this.year)},enumerable:!1,configurable:!0}),e.prototype.getDays=function(){if(this.days.length)return this.days;for(var t=1;t<=30;t++){var r=new S({year:this.year,month:this.month,isLeapMonth:this.isLeapMonth,day:t,isLeapDay:!1});if(r.isDoubledDay){var n=new S({year:this.year,month:this.month,isLeapMonth:this.isLeapMonth,day:t,isLeapDay:!0});this.days.push(n)}r.isSkippedDay||this.days.push(r)}return this.days},e.prototype.toString=function(){var t="";return this.isDoubledMonth&&(t=this.isLeapMonth?"-leap":"-main"),"".concat(this.yearObj.toString(),"-").concat(this.month).concat(t)},e})(),Bt=(function(){function e(t){var r;t?typeof t=="string"?(this.westernDate=new Date(t),r=rt(this.westernDate)):(r=et(t),this.westernDate=r.westernDate):(this.westernDate=new Date,r=rt(this.westernDate)),this.isSkippedDay=r.skippedDay,this.isPreviousSkipped=r.isPreviousSkipped,this.isLeapDay=r.isLeapDay,this.isDoubledDay=r.isDoubledDay,this.date=r.day,this.year=r.year,this.month=r.month.month,this.monthObj=new I({year:r.year,month:r.month.month,isLeapMonth:r.month.isLeapMonth})}return Object.defineProperty(e.prototype,"day",{get:function(){return this.westernDate.getDay()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yearObj",{get:function(){return new G(this.year)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"westernDateStr",{get:function(){return E(this.westernDate)},enumerable:!1,configurable:!0}),e.prototype.getWesternDate=function(){return this.westernDate},e.prototype.getDate=function(){return this.date},e.prototype.getDay=function(){return this.westernDate.getDay()},e.prototype.getMonth=function(){return this.month},e.prototype.getMonthObj=function(){return this.monthObj},e.prototype.getYear=function(){return this.year},e.prototype.getYearObj=function(){return this.yearObj},e.prototype.toString=function(){var t="";return this.isDoubledDay&&(t=this.isLeapDay?"-leap":"-main"),"".concat(this.monthObj.toString(),"-").concat(this.date).concat(t)},e})(),S=Bt;a.TibetanDate=S,a.TibetanMonth=I,a.TibetanYear=G,a.getLosarForYear=Ft,Object.defineProperty(a,"__esModule",{value:!0})}))});var g=xt(st(),1),w=a=>document.getElementById(a),lt=a=>(a??"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#39;"),zt=["Wood","Fire","Earth","Iron","Water"],Kt=["Mouse","Ox","Tiger","Rabbit","Dragon","Snake","Horse","Sheep","Monkey","Bird","Dog","Pig"],Xt=["Male","Female"],Qt={8:"Medicine Buddha & Tara Day",10:"Guru Rinpoche Day",15:"Amitabha Buddha Day; Full Moon",25:"Dakini Day",29:"Dharmapala Day",30:"Shakyamuni Buddha Day; New Moon"},Vt=["\u0F51\u0F44\u0F0B\u0F54\u0F7C\u0F0D","\u0F42\u0F49\u0F72\u0F66\u0F0B\u0F54\u0F0D","\u0F42\u0F66\u0F74\u0F58\u0F0B\u0F54\u0F0D","\u0F56\u0F5E\u0F72\u0F0B\u0F54\u0F0D","\u0F63\u0F94\u0F0B\u0F54\u0F0D","\u0F51\u0FB2\u0F74\u0F42\u0F0B\u0F54\u0F0D","\u0F56\u0F51\u0F74\u0F53\u0F0B\u0F54\u0F0D","\u0F56\u0F62\u0F92\u0FB1\u0F51\u0F0B\u0F54\u0F0D","\u0F51\u0F42\u0F74\u0F0B\u0F54\u0F0D","\u0F56\u0F45\u0F74\u0F0B\u0F54\u0F0D","\u0F56\u0F45\u0F74\u0F0B\u0F42\u0F45\u0F72\u0F42\u0F0B\u0F54\u0F0D","\u0F56\u0F45\u0F74\u0F0B\u0F42\u0F49\u0F72\u0F66\u0F0B\u0F54\u0F0D"],Zt="\u0F20\u0F21\u0F22\u0F23\u0F24\u0F25\u0F26\u0F27\u0F28\u0F29".split(""),te=["\u0F49\u0F72\u0F0D","\u0F5F\u0FB3\u0F0D","\u0F51\u0F58\u0F62\u0F0D","\u0F63\u0FB7\u0F42","\u0F55\u0F74\u0F62\u0F0D","\u0F66\u0F44\u0F66\u0F0D","\u0F66\u0FA4\u0F7A\u0F53\u0F0D"],ee=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],re=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ae(a){return String(a).split("").map(o=>o>="0"&&o<="9"?Zt[+o]:o).join("")}function ct(a){return a%10===2&&a%100!==12?`${a}nd`:a%10===1&&a%100!==11?`${a}st`:a%10===3&&a%100!==13?`${a}rd`:`${a}th`}function ne(a){a=+a;let o=w("calendar"),s=[];if(o.replaceChildren(),!(a>0&&a<1e4))return;let i=new g.TibetanYear(a,!0),l=`Tibetan Year ${i.tibYearNum} \u2013 ${i.gender} ${i.element} ${i.animal} Year of the ${ct(i.rabjungCycle)} Rabjung Calendrical Cycle (${i.westernYear})`;s.push(`<br><h2>${lt(l)}</h2>`);for(let f=1;f<=12;f++)s=s.concat(ft(i,f));o.innerHTML=s.join("")}function ft(a,o,s=!1){let i=[],l=new g.TibetanMonth({year:a.tibYearNum,month:o});l.isDoubledMonth&&!s&&(i=i.concat(ft(a,o,!0))),i.push(`
<br>
<table class="tbl" border="0" cellspacing="1" cellpadding="2">
	<tr><th colspan="6">
		<span class="tibtit">\u0F56\u0F7C\u0F51\u0F0B\u0F5F\u0FB3\u0F0B${Vt[o-1]}</span> &nbsp;&ndash;&nbsp; ${ct(o)} Tibetan Month ${l.isDoubledMonth?"(+)":""}
	</th></tr>
`);let f,b;for(let p=1;p<=30;p++){let L=new g.TibetanDate({year:a.tibYearNum,month:o,isLeapMonth:s,day:p});if(L.isDoubledDay){let A=new g.TibetanDate({year:a.tibYearNum,month:o,isLeapMonth:s,day:p,isLeapDay:!0});[f,b]=ht(p,A,b),i.push(ut(A,f))}[f,b]=ht(p,L,b),L.isSkippedDay||i.push(ut(L,f))}return i.push("</table>"),i}function ut(a,o){let s=a.isPreviousSkipped&&(!a.isDoubledDay||a.isLeapDay);return`
<tr>
	<td><span class="tib">&nbsp;${te[a.day]}</span></td>
	<td><span class="tib">${ae(a.date)}</span></td>
	<td>&nbsp;${a.date} ${s?"*":""}${a.isDoubledDay?"+":""}</td>
	<td class="mark">${ee[a.day]}</td>
	<td>${re[a.westernDate.getMonth()]} ${a.westernDate.getDate()}</td>
	<td class="mark"><i>${lt(o)}&nbsp;</i></td>
</tr>
`}function ht(a,o,s){let i,l=Qt[String(a)];return o.month===1&&o.date===1&&(l="Losar"),s&&(i=`${s} (carried over)`),l?o.isSkippedDay?[null,l]:o.isDoubledDay&&!o.isLeapDay?[i,null]:(i?i+=`; ${l}`:i=l,[i,null]):[i,null]}function pt(){let a=+w("year-input").value;a>0&&ne(a)}w("make-calendar").addEventListener("click",pt);w("year-input").addEventListener("keypress",a=>a.key==="Enter"&&pt());w("year-input").focus();var T=new Date().getFullYear();T=T-(T+5)%12;vt(T);function vt(a){if(a=+a,!(a>0))return;T=a;let o=[];for(let s=a;s<a+12;s++){let i=s+127,l=Kt[(i+1)%12],f=zt[Math.floor((i-1)/2)%5],b=Xt[(i+1)%2],p=Math.ceil((s-1026)/60);o.push(`
<tr>
<td></td>
<td></td>
<td>${s}</td>
<td>${i}</td>
<td>${b}</td>
<td>${f}</td>
<td>${l}</td>
<td>${p}</td>
<td></td>
<td></td>
</tr>`)}w("rabjung-years").innerHTML=o.join("")}document.querySelector("#rabjung tr.arrows").addEventListener("click",a=>{let o=+a.target.dataset.add;(o>0||o<0)&&vt(T+o)});document.querySelector("#rabjung tr.arrows").addEventListener("dblclick",a=>{a.preventDefault()});})();
